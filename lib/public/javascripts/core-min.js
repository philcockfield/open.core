/*
  Copyright 2011 Phil Cockfield. All rights reserved.
  The MIT License (MIT)
  https://github.com/philcockfield/open.core
*/
(function(){if(!this.require){var a={},b={},c=function(f,g){var h=b[f],i=d(g,f),j;if(h)return h;if(!(j=a[i]||a[i=d(i,"./index")]))throw"module '"+f+"' not found";h={id:f,exports:{}};try{b[f]=h.exports,j(h.exports,function(a){return c(a,e(i))},h);return b[f]=h.exports}catch(k){delete b[f];throw k}},d=function(a,b){var c=[],d,e;/^\.\.?(\/|$)/.test(b)?d=[a,b].join("/").split("/"):d=b.split("/");for(var f=0,g=d.length;f<g;f++)e=d[f],e==".."?c.pop():e!="."&&e!=""&&c.push(e);return c.join("/")},e=function(a){return a.split("/").slice(0,-1).join("/")};this.require=function(a){return c(a,"")},this.require.define=function(b){for(var c in b)a[c]=b[c]}}return this.require.define}).call(this)({"open.client/controls/button":function(a,b,c){(function(){var a,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f=Object.prototype.hasOwnProperty,g=function(a,b){function d(){this.constructor=a}for(var c in b)f.call(b,c)&&(a[c]=b[c]);d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype;return a};d=b("open.client/core"),c.exports=a=function(){function a(b){var c,d,f,g;b==null&&(b={}),this._stateChanged=e(this._stateChanged,this),this.handleStateChanged=e(this.handleStateChanged,this),this.toggle=e(this.toggle,this),this.onSelected=e(this.onSelected,this),this.onClick=e(this.onClick,this),this.click=e(this.click,this),c=this,a.__super__.constructor.call(this,b),this.addProps({label:(d=b.label)!=null?d:b.label="",canToggle:(f=b.canToggle)!=null?f:b.canToggle=!1,selected:(g=b.selected)!=null?g:b.selected=!1,over:!1,down:!1}),this.selected.onChanged(e(function(){var a;a=c.selected(),c._stateChanged("selected"),c.handleSelectedChanged({selected:a});if(c.canToggle()&&a)return c.trigger("selected",{source:c})},this)),function(){var a,b;a=c.el,b=c._stateChanged,a.mouseenter(e(function(a){c.over(!0);return b("mouseenter")},this)),a.mouseleave(e(function(a){c.over(!1),c.down(!1);return b("mouseleave")},this)),a.mousedown(e(function(a){c.down(!0);return b("mousedown")},this));return a.mouseup(e(function(a){c.down(!1);return c.click()},this))}()}g(a,d.mvc.View),a.prototype.click=function(a){var b,c;a==null&&(a={}),c={source:this,cancel:!1};if(!!this.enabled()){b=a.silent!==!0;if(b){this.trigger("pre:click",c);if(c.cancel===!0){this._stateChanged("click:cancelled");return!1}}this.toggle(),b&&this.trigger("click",{source:this}),this._stateChanged("click");return!0}},a.prototype.onClick=function(a){if(a!=null)return this.bind("click",a)},a.prototype.onSelected=function(a){if(a!=null)return this.bind("selected",a)},a.prototype.toggle=function(){if(!this.canToggle())return!1;this.selected(!this.selected());return!0},a.prototype.handleStateChanged=function(a){},a.prototype.handleSelectedChanged=function(a){},a.prototype._stateChanged=function(a){var b;b={source:this,state:a},this.trigger("stateChanged",b);return this.handleStateChanged(b)};return a}()}).call(this)},"open.client/controls/button_set":function(a,b,c){(function(){var a,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype;return a},g=function(a,b){return function(){return a.apply(b,arguments)}};d=b("open.client/core"),c.exports=a=function(){function a(){a.__super__.constructor.apply(this,arguments),_.extend(this,Backbone.Events),this.length=0,this.buttons=new d.mvc.Collection}f(a,d.Base),a.prototype.buttons=void 0,a.prototype.selected=function(){return this.buttons.select(function(a){return a.canToggle()&&a.selected()})[0]},a.prototype.togglable=function(){return this.buttons.select(function(a){return a.canToggle()})},a.prototype.add=function(a,b){b==null&&(b={});if(a==null)throw"add: no button";if(this.buttons.include(a))return a;this.buttons.add(a,b),this.length=this.buttons.length,a.bind("pre:click",function(b){if(a.selected())return b.cancel=!0}),a.selected.onChanged(g(function(b){var c,d,e,f;if(!!a.canToggle()){if(b.oldValue===!0)return;f=this.togglable();for(d=0,e=f.length;d<e;d++)c=f[d],c!==a&&c.canToggle()&&c.selected()&&c.selected(!1);return this._fire("selectionChanged",{button:a})}},this)),b.silent||(this._fire("add"),this._fireChanged());return a},a.prototype.remove=function(a,b){var c;b==null&&(b={});if(a==null)throw"remove: no button";if(!this.buttons.include(a))return!1;(c=b._fireChanged)!=null?c:b._fireChanged=!0,this.buttons.remove(a,b),this.length=this.buttons.length,a.unbind("pre:click"),a.selected.unbind("changed"),b.silent||(this._fire("remove"),b._fireChanged&&this._fireChanged());return!0},a.prototype.clear=function(a){var b,c,d,e,f;a==null&&(a={}),(f=a.silent)!=null?f:a.silent=!1,a._fireChanged=!1,c=this.buttons.select(function(){return!0});for(d=0,e=c.length;d<e;d++)b=c[d],this.remove(b,a);a.silent||(this._fire("clear"),this._fireChanged());return null},a.prototype.contains=function(a){return this.buttons.include(a)},a.prototype._fire=function(a,b){b==null&&(b={}),b.source=this;return this.trigger(a,b)},a.prototype._fireChanged=function(){return this._fire("changed")};return a}()}).call(this)},"open.client/controls/index":function(a,b,c){(function(){c.exports={Button:b("./button"),ButtonSet:b("./button_set"),Textbox:b("./textbox")}}).call(this)},"open.client/controls/textbox/index":function(a,b,c){(function(){var a,d,e,f,g=Object.prototype.hasOwnProperty,h=function(a,b){function d(){this.constructor=a}for(var c in b)g.call(b,c)&&(a[c]=b[c]);d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype;return a},i=function(a,b){return function(){return a.apply(b,arguments)}};e=b("open.client/core"),a=b("./tmpl"),f=function(a,b){var c,d,e,f;c=!1,d=function(a){c=!0,a();return c=!1},e=function(){if(!c)return d(function(){return b.val(a())})},e(),a.onChanged(e),f=function(){if(!c)return d(function(){return a(b.val())})},b.keyup(f);return b.change(f)},c.exports=d=function(){function b(a){var c,d;a==null&&(a={}),b.__super__.constructor.call(this,_.extend(a,{tagName:"span",className:"core_textbox"})),this.render(),d=i(function(){return this.$("span.core_watermark").html(this.empty()?this.watermark():"")},this),this.multiline.onChanged(i(function(){return this.render()},this)),this.password.onChanged(i(function(){return this.render()},this)),this.watermark.onChanged(d),this.text.onChanged(d),this._.input.keyup(i(function(a){a.keyCode===13&&this.enterPress();if(a.keyCode===27)return this.escapePress()},this)),_.extend(this._,c={press:i(function(a){return this.trigger("press:"+a,{source:self})},this),onPress:i(function(a,b){return this.bind("press:"+a,b)},this)}),d()}h(b,e.mvc.View),b.prototype.defaults={text:"",multiline:!1,password:!1,watermark:""},b.prototype.render=function(){var b,c,d,e;d=this.password()?"password":"text",e=new a,b=e.root({textbox:this,inputType:d}),this.html(b),c=this.multiline()?this.$("textarea"):this.$("input"),this._.syncer=new f(this.text,c),this._.input=c;return this},b.prototype.focus=function(){return this._.input.focus()},b.prototype.hasFocus=function(){return this.$("input:focus").length===1},b.prototype.empty=function(a){var b;a==null&&(a=!0),b=this.text();if(b==null)return!0;a&&(b=_.trim(b));return b===""?!0:!1},b.prototype.enterPress=function(){return this._.press("enter")},b.prototype.escapePress=function(){return this._.press("escape")},b.prototype.onEnter=function(a){return this._.onPress("enter",a)},b.prototype.onEscape=function(a){return this._.onPress("escape",a)};return b}()}).call(this)},"open.client/controls/textbox/tmpl":function(a,b,c){(function(){var a,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype;return a};d=b("open.client/core"),c.exports=a=function(){function a(){a.__super__.constructor.apply(this,arguments)}f(a,d.mvc.Template),a.prototype.root='<span class="core_inner">\n  &nbsp;\n  <span class="core_watermark"></span>\n  <% if (textbox.multiline()) { %>\n    <textarea></textarea>\n  <% } else { %>\n    <input type="<%= inputType %>" />\n  <% } %>\n</span>';return a}()}).call(this)},"open.client/core/base":function(a,b,c){(function(){var a,d,e=function(a,b){return function(){return a.apply(b,arguments)}};d=b("./util/property"),c.exports=a=function(){function a(){}a.prototype.addProps=function(a){var b,c,e,f,g;if(a!=null){e=this,f=this.propertyStore(),b=function(b){var c,g,h;c=a[b],h=new d({name:b,"default":c,store:f}),e[b]=h.fn,e.onPropAdded!=null&&e.onPropAdded(h);if(e.onChanged!=null){g=function(a){return a.fn.onChanged(function(a){return e.onChanged(a)})};return g(h)}},g=[];for(c in a){if(this.hasOwnProperty(c))throw"Add property fail. ["+c+"] exists";g.push(b(c))}return g}},a.prototype.propertyStore=function(){var a,b,c;a=(b=this._)!=null?b:this._={};return(c=a.basePropertyStore)!=null?c:a.basePropertyStore={}},a.prototype.bubble=function(a,b){this.bind==null&&_.extend(this,Backbone.Events),b.bind(a,e(function(b){b==null&&(b={}),b.source=this;return this.trigger(a,b)},this));return this};return a}()}).call(this)},"open.client/core/index":function(a,b,c){(function(){var a,d,e;d=function(a){return b("open.client/core/"+a)},e=d("util"),c.exports=a={title:"Open.Core (Client)",Base:d("base"),mvc:d("mvc"),util:e,tryRequire:e.tryRequire}}).call(this)},"open.client/core/mvc/_common":function(a,b,c){(function(){c.exports={using:function(a){return b("open.client/core/mvc/"+a)},sync:function(a,b,c,d){var e,f;d==null&&(d={}),e=function(a,d){return b[c].trigger(a,d)},f=function(a,c,d,f){var g;g={source:b,response:a,success:c,error:d},e("complete",g);return typeof f=="function"?f(g):void 0},e("start",{source:b});return a.call(b,{success:function(a,b){return f(b,!0,!1,d.success)},error:function(a,b){return f(b,!1,!0,d.error)}})}}}).call(this)},"open.client/core/mvc/collection":function(a,b,c){(function(){var a,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype;return a};d=b("open.client/core/mvc/_common"),c.exports=a=function(){function a(){a.__super__.constructor.apply(this,arguments),_.extend(this.fetch,Backbone.Events)}f(a,Backbone.Collection),a.prototype.fetch=function(a){var b,c;b="fetch",c=Backbone.Collection.prototype[b];return d.sync(c,this,b,a)},a.prototype.onFetched=function(a){if(a!=null)return this.fetch.bind("complete",a)};return a}()}).call(this)},"open.client/core/mvc/data_binder":function(a,b,c){(function(){var a,d,e;e=b("open.client/core/mvc/_common"),d=e.using("view"),c.exports=a=function(){function a(a,b){var c,e,f,g,h;if(b instanceof d)this.el=b.el;else if(b instanceof jQuery)this.el=b;else throw"View type not supported";c=function(b){var c,d;c=a[b.attr("data-bind")],d=function(){return b.html(c())},d();return c.onChanged(function(a){return d()})},h=this.el.find("[data-bind]");for(f=0,g=h.length;f<g;f++)e=h[f],c($(e))}return a}()}).call(this)},"open.client/core/mvc/index":function(a,b,c){(function(){var a,d;a=b("open.client/core/mvc/_common"),d=a.using,c.exports={Model:d("model"),View:d("view"),Template:d("template"),Collection:d("collection"),Module:d("module"),DataBinder:d("data_binder")}}).call(this)},"open.client/core/mvc/model":function(a,b,c){(function(){var a,d,e,f,g=Object.prototype.hasOwnProperty,h=function(a,b){function d(){this.constructor=a}for(var c in b)g.call(b,c)&&(a[c]=b[c]);d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype;return a},i=function(a,b){return function(){return a.apply(b,arguments)}};a=b("../base"),f=b("./_common"),e=new a,c.exports=d=function(){function a(b){var c;b==null&&(b={}),a.__super__.constructor.apply(this,arguments),c=this,_.extend(this,e),this.propertyStore=i(function(){var a;return a=i(function(a,b,d){var e;b!==void 0&&(e={},e[a]=b,c.set(e,d));return c.get(a)},this)},this),c.addProps(this.defaults),i(function(){var a;a=function(a){_.extend(a,Backbone.Events);return a.onComplete=function(b){return a.bind("complete",b)}},a(this.fetch),a(this.save);return a(this.destroy)},this)()}h(a,Backbone.Model),a.prototype.addProps=function(a){},a.prototype.fetch=function(a){return this._sync(this,"fetch",a)},a.prototype.save=function(a){return this._sync(this,"save",a)},a.prototype.destroy=function(a){return this._sync(this,"destroy",a)},a.prototype._sync=function(a,b,c){var d;c==null&&(c={}),d=Backbone.Model.prototype[b];return f.sync(d,a,b,c)};return a}()}).call(this)},"open.client/core/mvc/module":function(a,b,c){(function(){var a,d,e,f,g,h=Object.prototype.hasOwnProperty,i=function(a,b){function d(){this.constructor=a}for(var c in b)h.call(b,c)&&(a[c]=b[c]);d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype;return a},j=function(a,b){return function(){return a.apply(b,arguments)}};f=function(a){return b("open.client/core/"+a)},a=f("base"),e=f("/mvc/_common"),g=f("util"),c.exports=d=function(){function b(a){var c;this.modulePath=a,b.__super__.constructor.apply(this,arguments),c=j(function(a){return j(function(b,c){var d;b==null&&(b=""),c==null&&(c={}),(d=c["throw"])!=null?d:c["throw"]=!0;return this.tryRequire(""+this.modulePath+"/"+a+"/"+b,c)},this)},this),this.require={model:c("models"),view:c("views"),controller:c("controllers")}}i(b,a),b.prototype.tryRequire=g.tryRequire,b.prototype.rootView=null,b.prototype.init=function(a){var b;a==null&&(a={}),b=function(a){return a("",{"throw":!1})},this.index={models:b(this.require.model),views:b(this.require.view),controllers:b(this.require.controller)};return a.within=g.toJQuery(a.within)};return b}()}).call(this)},"open.client/core/mvc/template":function(a,b,c){(function(){var a;c.exports=a=function(){function a(){var a,b,c;a=["constructor"];for(b in this)_(a).any(function(a){return a===b})||(c=this[b],_(c).isString()&&(this[b]=this.toTemplate(c)))}a.prototype.toTemplate=function(a){return new _.template(a)};return a}()}).call(this)},"open.client/core/mvc/view":function(a,b,c){(function(){var a,d,e,f,g=Object.prototype.hasOwnProperty,h=function(a,b){function d(){this.constructor=a}for(var c in b)g.call(b,c)&&(a[c]=b[c]);d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype;return a},i=function(a,b){return function(){return a.apply(b,arguments)}};e=b("open.client/core/mvc/_common"),a=e.using("model"),f=function(a,b){var c;c=b?"":"none";return a.el.css("display",c)},c.exports=d=function(){function b(a){var c;a==null&&(a={}),b.__super__.constructor.apply(this,arguments),this.addProps({enabled:!0,visible:!0}),c=new Backbone.View({tagName:a.tagName,className:a.className,el:a.el}),this._={view:c,atts:a},this.element=c.el,this.el=$(this.element),this.visible.onChanged(i(function(a){return f(this,a.newValue)},this)),this.$=c.$}h(b,a),b.prototype.html=function(a){var b;b=this.el,a!=null&&b.html(a);return b.html()};return b}()}).call(this)},"open.client/core/util/_conversion":function(a,b,c){(function(){c.exports={toBool:function(a){if(_.isBoolean(a))return a;if(a==null)return!1;if(_.isString(a)){a=_.trim(a).toLowerCase();return a==="true"||a==="on"||a==="yes"?!0:a==="false"||a==="off"||a==="no"?!1:null}if(_.isNumber(a))return a===1?!0:a===0?!1:null;return null},toJQuery:function(a){if(a==null)return a;if(a instanceof jQuery)return a;if(a.el instanceof jQuery)return a.el;if(_.isString(a)||a instanceof HTMLElement)return $(a);throw"Cannot convert to jQuery object: "+a}}}).call(this)},"open.client/core/util/index":function(a,b,c){(function(){var a,d;a=function(a){return b("open.client/core/util/"+a)},a("jquery"),d={Property:a("property"),tryRequire:function(a,b){var c,d,e,f;b==null&&(b={}),d=(e=b["throw"])!=null?e:b["throw"]=!1,c=(f=b.log)!=null?f:b.log=!1;try{return window.require(a)}catch(g){if(d)throw g;if(c)return typeof console!="undefined"&&console!==null?console.log("[tryRequire] Failed to load module: "+a):void 0}}},_.extend(d,a("_conversion")),c.exports=d}).call(this)},"open.client/core/util/jquery":function(a,b,c){(function(){$.extend($.fn.disableTextSelect=function(){return this.each(function(){return $.browser.mozilla?$(this).css("MozUserSelect","none"):$.browser.msie?$(this).bind("selectstart",function(){return!1}):$(this).mousedown(function(){return!1})})})}).call(this)},"open.client/core/util/property":function(a,b,c){(function(){var a,b,d=function(a,b){return function(){return a.apply(b,arguments)}};b=d(function(a,b,c){var e;c.property=b,e=d(function(b){return b.trigger(a,c)},this),e(b),e(b.fn);return c},this),c.exports=a=function(){function a(a){var b,c;a==null&&(a={}),this.fireChanged=d(this.fireChanged,this),this.fireChanging=d(this.fireChanging,this),this.write=d(this.write,this),this.read=d(this.read,this),this.fn=d(this.fn,this),b=this.fn,b._parent=this,this.name=a.name,this._={store:a.store,"default":(c=a["default"])!=null?c:a["default"]=null},_.extend(this,Backbone.Events),_.extend(b,Backbone.Events),b.onChanging=function(a){return b.bind("changing",a)},b.onChanged=function(a){return b.bind("changed",a)}}a.prototype.fn=function(a,b){a!==void 0&&this.write(a,b);return this.read()},a.prototype.read=function(){var a,b;a=this._.store,_.isFunction(a)?b=a(this.name):b=a[this.name],b===void 0&&(b=this._["default"]);return b},a.prototype.write=function(a,b){var c,d,e,f;b==null&&(b={});if(a!==void 0){d=this.read();if(a===d)return;(f=b.silent)!=null?f:b.silent=!1;if(b.silent===!1){c=this.fireChanging(d,a);if(c.cancel===!0)return}e=this._.store,_.isFunction(e)?e(this.name,a,b):e[this.name]=a;if(b.silent===!1)return this.fireChanged(d,a)}},a.prototype.fireChanging=function(a,c){var d;d={oldValue:a,newValue:c,cancel:!1},b("changing",this,d);return d},a.prototype.fireChanged=function(a,c){return b("changed",this,{oldValue:a,newValue:c})};return a}()}).call(this)}})